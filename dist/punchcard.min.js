!function(t,s,i,n){"use strict";function e(s,i){this.element=s,this.settings=t.extend({},d,i),this._defaults=d,this._name=h,this.data=c(this.settings.days.length,this.settings.hours.length),this.settingsData=null,this.size=[],this.init()}var a=10,r=moment("20160101"),h="punchcard",d={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],hours:["24","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],singular:n,plural:n,data:n,timezones:[],timezoneIndex:0,nightModeFrom:n,nightModeTo:n};t.extend(e.prototype,{init:function(){this.settings.data&&(t(this.element).addClass("punchcard"),this.refresh())},render:function(){t(this.element).empty(),this.applyTimezone(),this.calcSize(),this.addDays()},refresh:function(){var s=this,i=this.settings.data;u(i)&&(i=i(this.settings,this)),l(i)?(this.settingsData=null,this.render(),t(this.element).addClass("punchcard-loading"),i.then(function(i){s.settingsData=i,s.render(),t(s.element).removeClass("punchcard-loading punchcard-error")},function(i){t(s.element).removeClass("punchcard-loading"),t(s.element).addClass("punchcard-error")})):(this.settingsData=i,this.render())},changeTimezone:function(t){this.settings.timezoneIndex=t,this.render()},applyTimezone:function(){for(var t=o(this.settings.timezones,this.settings.timezoneIndex),s=this.settings.days.length,i=this.settings.hours.length,n=s*i,e=0;e<s;e++)for(var a=0;a<i;a++){var r=0;this.settingsData&&this.settingsData[e]&&this.settingsData[e][a]&&(r=0|this.settingsData[e][a]);var h=i*e+a+t;h=h>0?h:n+h;var d=Math.floor(h/i)%s,c=h%i;this.data[d][c]=r}},calcSize:function(){this.size=[];for(var t in this.settings.days){var s=0;for(var i in this.settings.hours){var e=this.data[t][i];e!=n&&0!=e&&s<e&&(s=e)}var r=[];for(var i in this.settings.hours){var e=this.data[t][i];if(e==n)break;var h=e/s;r.push(Math.ceil(h*a))}this.size.push(r)}},addDays:function(){var s="";for(var i in this.settings.days){s+='<div class="punch-card-day">    <div class="punch-card-day-name">         <div class="punch-card-day-name-label">'+this.settings.days[i]+"</div>     </div >";for(var n in this.settings.hours){var e=0|this.data[i][n],a=0|this.size[i][n];s+='<div class="punch-card-hour">     <div class="punch-card-hour-data size-'+a+'"></div>     <div class="punch-card-hour-tooltip">         <b>'+e+"</b> "+this.description(e)+'         <div class="arrow"></div>     </div>     <div class="punch-card-hour-tick"></div> </div >'}s+="</div > "}s+='<div class="punch-card-hour-name">';for(var n in this.settings.hours)s+='    <div class="punch-card-hour-name-label">'+this.settings.hours[n]+"    </div>";s+="</div>",t(this.element).html(s)},description:function(t){return 1==t?this.settings.singular||"event":this.settings.plural||"events"}}),t.fn[h]=function(s){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=t(this),a=n.data("plugin_"+h);a?"string"==typeof s&&a[s].apply(a,i):n.data("plugin_"+h,new e(this,s))})};var o=function(t,s){var i="local",n=0;return t.length>0&&(s=s<0||s>=t.length?0:s,i=t[s].toLowerCase()),n="utc"==i?0:"local"==i?Math.floor(r.local().utcOffset()/60):Math.floor(r.tz(i).utcOffset()/60)},c=function(t){var s=new Array(t||0),i=t;if(arguments.length>1)for(var n=Array.prototype.slice.call(arguments,1);i--;)s[t-1-i]=c.apply(this,n);return s},u=function(t){return"function"==typeof t&&!t.then},l=function(t){return"function"==typeof t.then}}(jQuery,window,document);