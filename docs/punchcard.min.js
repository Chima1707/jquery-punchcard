!function(t,i,s,e){"use strict";function a(i,s){this.element=i,this.settings=t.extend({},d,s),this._defaults=d,this._name=h,this.data=c(this.settings.days.length,this.settings.hours.length),this.size=[],this.initialWidth=0,this.init()}var n=10,r=moment("20160101"),h="punchcard",d={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],hours:["24","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],singular:e,plural:e,data:e,ajax:e,timezones:[],timezoneIndex:0,nightModeFrom:e,nightModeTo:e};t.extend(a.prototype,{init:function(){this.settings.data&&(t(this.element).addClass("punchcard"),this.applyTimezone(),this.calcSize(),this.addDays(),this.initialWidth=t(this.element).width(),this.registerResizeListener(),this.setScale())},registerResizeListener:function(){var s=this;t(i).resize(function(){s.setScale()})},setScale:function(){var i=t(this.element).parent().width(),s=i/this.initialWidth;t(this.element).css("transform","scale("+s+")")},refresh:function(){t(this.element).empty(),this.applyTimezone(),this.calcSize(),this.addDays()},changeTimezone:function(t){this.settings.timezoneIndex=t,this.refresh()},applyTimezone:function(){for(var t=o(this.settings.timezones,this.settings.timezoneIndex),i=this.settings.days.length,s=this.settings.hours.length,e=i*s,a=0;a<i;a++)for(var n=0;n<s;n++){var r=0|this.settings.data[a][n],h=s*a+n+t;h=h>0?h:e+h;var d=Math.floor(h/s)%i,c=h%s;this.data[d][c]=r}},calcSize:function(){this.size=[];for(var t in this.settings.days){var i=0;for(var s in this.settings.hours){var a=this.data[t][s];a!=e&&0!=a&&i<a&&(i=a)}var r=[];for(var s in this.settings.hours){var a=this.data[t][s];if(a==e)break;var h=a/i;r.push(Math.ceil(h*n))}this.size.push(r)}},addDays:function(){var i="";for(var s in this.settings.days){i+='<div class="punch-card-day">    <div class="punch-card-day-name">         <div class="punch-card-day-name-label">'+this.settings.days[s]+"</div>     </div >";for(var e in this.settings.hours){var a=0|this.data[s][e],n=0|this.size[s][e];i+='<div class="punch-card-hour">     <div class="punch-card-hour-data size-'+n+'"></div>     <div class="punch-card-hour-tooltip">         <b>'+a+"</b> "+this.description(a)+'         <div class="arrow"></div>     </div>     <div class="punch-card-hour-tick"></div> </div >'}i+="</div > "}i+='<div class="punch-card-hour-name">';for(var e in this.settings.hours)i+='    <div class="punch-card-hour-name-label">'+this.settings.hours[e]+"    </div>";i+="</div>",t(this.element).html(i)},description:function(t){return 1==t?this.settings.singular||"event":this.settings.plural||"events"}}),t.fn[h]=function(i){var s=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=t(this),n=e.data("plugin_"+h);n?"string"==typeof i&&n[i].apply(n,s):e.data("plugin_"+h,new a(this,i))})};var o=function(t,i){var s="local",e=0;return t.length>0&&(i=i<0||i>=t.length?0:i,s=t[i].toLowerCase()),e="utc"==s?0:"local"==s?Math.floor(r.local().utcOffset()/60):Math.floor(r.tz(s).utcOffset()/60)},c=function(t){var i=new Array(t||0),s=t;if(arguments.length>1)for(var e=Array.prototype.slice.call(arguments,1);s--;)i[t-1-s]=c.apply(this,e);return i}}(jQuery,window,document);